{"version":3,"sources":["XMLHTTP.js"],"names":["cc","Class","extends","Component","properties","apiurl","xmlHttpGet","url","params","sendcookie","successCallBack","failCallBack","paramstr","arrs","k","push","join","xhr","loader","getXMLHttpRequest","timeout","withCredentials","setRequestHeader","responseType","onreadystatechange","readyState","status","response","JSON","parse","responseText","header","cookie","getResponseHeader","statusText","log","ontimeout","abort","onerror","e","open","send","xmlHttpPost"],"mappings":"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","file":"XMLHTTP.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        apiurl:'http://lhhapi.wq176.cn/'\r\n    },\r\n     /*\r\n     *GET方法\r\n    *url请求链接\r\n    *params 参数对象{‘paramidx’:'paramitem'}\r\n    *successCallBack 成功执行操作\r\n    *failCallBack 失败执行操作\r\n    */\r\n    xmlHttpGet:function(url,params,sendcookie,successCallBack,failCallBack)\r\n    {\r\n        var paramstr='';\r\n        if(typeof params == 'object'){\r\n            var arrs = [];\r\n            for (var k in params){\r\n                arrs.push(k+'='+params[k]);\r\n            }\r\n            paramstr = '?'+arrs.join('&');\r\n        }\r\n        var xhr=cc.loader.getXMLHttpRequest();\r\n        xhr.timeout = 5000;\r\n        xhr.withCredentials = true;\r\n        if(sendcookie!='')\r\n        {\r\n            xhr.setRequestHeader(\"Cookie\",sendcookie)\r\n        }\r\n        xhr.responseType=\"json\";\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4) {\r\n                if( (xhr.status >= 200 && xhr.status < 400))\r\n                {\r\n                    //cc.log(xhr.responseText);\r\n                    var response = JSON.parse(xhr.responseText);\r\n                    var header={cookie:xhr.getResponseHeader(\"Set-Cookie\")};\r\n                    successCallBack(response,header);\r\n                }\r\n                else\r\n                {\r\n                    failCallBack(xhr.statusText);\r\n                }   \r\n            }\r\n            else\r\n            {\r\n                cc.log('请求中……'+url);\r\n            }\r\n        };\r\n        xhr.ontimeout=function(){\r\n            xhr.abort();\r\n            failCallBack('网络请求超时');\r\n        };\r\n        xhr.onerror=function(e){\r\n            //failCallBack('网络错误');\r\n        };\r\n        xhr.open(\"GET\",this.apiurl+url+paramstr, true);\r\n        \r\n        xhr.send();\r\n        \r\n    },\r\n    /*\r\n     *POST方法\r\n    *url请求链接\r\n    *params 参数对象{‘paramidx’:'paramitem'}\r\n    *successCallBack 成功执行操作\r\n    *failCallBack 失败执行操作\r\n    */\r\n    xmlHttpPost:function(url,params,sendcookie,successCallBack,failCallBack)\r\n    {\r\n        var paramstr='';\r\n        if(typeof params == 'object'){\r\n            var arrs = [];\r\n            for (var k in params){\r\n                arrs.push(k+'='+params[k]);\r\n            }\r\n            paramstr = arrs.join('&');\r\n        }\r\n        //cc.log(paramstr);\r\n        var xhr=cc.loader.getXMLHttpRequest();\r\n        xhr.timeout = 5000;\r\n        xhr.withCredentials = true;\r\n        if(sendcookie!='')\r\n        {\r\n            xhr.setRequestHeader(\"Cookie\",sendcookie)\r\n        }\r\n        xhr.responseType=\"json\";\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4) {\r\n                if( (xhr.status >= 200 && xhr.status < 400))\r\n                {\r\n                    var response = JSON.parse(xhr.responseText);\r\n                    var header={cookie:xhr.getResponseHeader(\"Set-Cookie\")};\r\n                    successCallBack(response,header);\r\n                }\r\n                else\r\n                {\r\n                    failCallBack(xhr.statusText);\r\n                }   \r\n            }\r\n            else\r\n            {\r\n                cc.log('请求中……'+url);\r\n            }\r\n        };\r\n        xhr.ontimeout=function(){\r\n            xhr.abort();\r\n            failCallBack('网络请求超时');\r\n        };\r\n        xhr.onerror=function(e){\r\n            //failCallBack('网络错误');\r\n        };\r\n        xhr.open(\"POST\",this.apiurl+url, true);\r\n        xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');\r\n        xhr.send(paramstr);\r\n    }\r\n});\r\n"]}