{"version":3,"sources":["startBtnClick.js"],"names":["XMLHTTP","require","startBtnClick","cc","Class","extends","Component","cotr","properties","xhr","default","type","btnbox","Node","loginboard","registerboard","reguser","regpass","regconfirmpass","regtjren","loginuser","loginpass","tankuang","tankuangtxt","Label","onLoad","userinfo","JSON","parse","sys","localStorage","getItem","name","string","showBtnbox","active","closeBtnbox","showLoginUi","closeRegisterUi","closeLoginUi","showReisterUi","httpFail","res","find","getComponent","Animation","play","gustBtn","xmlHttpGet","loginSuccess","tanKuang","msg","registerBtn","username","pass","confirmpass","tjren","parseInt","length","isNaN","xmlHttpPost","header","udata","utype","uid","coin","setItem","stringify","cookie","director","loadScene","loginBtn"],"mappings":"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","file":"startBtnClick.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["const XMLHTTP=require(\"XMLHTTP\");\r\n var startBtnClick=cc.Class({\r\n    extends: cc.Component,\r\n   \r\n    cotr:function(){\r\n\r\n    },\r\n    properties: {\r\n        xhr:{\r\n            default: null,\r\n            type: XMLHTTP\r\n        },\r\n        btnbox:cc.Node,\r\n        loginboard:cc.Node,\r\n        registerboard:cc.Node,\r\n        reguser:cc.Component,\r\n        regpass:cc.Component,\r\n        regconfirmpass:cc.Component,\r\n        regtjren:cc.Component,\r\n        loginuser:cc.Component,\r\n        loginpass:cc.Component,\r\n        tankuang:cc.Node,\r\n        tankuangtxt:cc.Label\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad:function () {\r\n        var userinfo=JSON.parse(cc.sys.localStorage.getItem(\"userinfo\"));\r\n        if(userinfo.name)\r\n        {\r\n            this.loginuser.string=userinfo.name;\r\n        }\r\n    },\r\n\r\n    //start () {},\r\n\r\n    // update (dt) {},\r\n    showBtnbox:function(){\r\n        if(!this.btnbox.active)\r\n        {\r\n            this.btnbox.active=true;\r\n        }\r\n    },\r\n    closeBtnbox:function(){\r\n        this.btnbox.active=false;\r\n    },\r\n    showLoginUi:function(){\r\n        this.closeRegisterUi();\r\n        this.loginboard.active=true;\r\n    },\r\n    closeLoginUi:function(){\r\n        this.loginboard.active=false;\r\n    },\r\n    showReisterUi:function(){\r\n        this.closeLoginUi();\r\n        this.registerboard.active=true;\r\n    },\r\n    closeRegisterUi:function(){\r\n        this.registerboard.active=false;\r\n    },\r\n    httpFail:function(res){\r\n        var tankuang=cc.find(\"Canvas/box/tankuangbg\");\r\n        var tankuangtxt=cc.find(\"Canvas/box/tankuangbg/msgtxt\").getComponent(cc.Label);\r\n        if(!tankuang.active)\r\n        {\r\n            tankuang.active=true;\r\n        }\r\n        tankuangtxt.string=res;\r\n        tankuang.getComponent(cc.Animation).play();\r\n    },\r\n    /*游客按钮点击事件*/\r\n    gustBtn:function(){\r\n        this.xhr.xmlHttpGet('api/guestLogin.do','','',this.loginSuccess,this.httpFail);\r\n    },\r\n    tanKuang:function(msg){\r\n        this.tankuangtxt.string=msg;\r\n        this.tankuang.active=true;\r\n        this.tankuang.getComponent(cc.Animation).play();\r\n    },\r\n    registerBtn:function(){\r\n        var username=this.reguser.string;\r\n        var pass=this.regpass.string;\r\n        var confirmpass=this.regconfirmpass.string;\r\n        var tjren=parseInt(this.regtjren.string);\r\n        var msg='';\r\n        if(username=='')\r\n        {\r\n            msg=\"请输入用户名\";\r\n            \r\n        }\r\n        else if(username.length<6)\r\n        {\r\n            msg=\"帐号不能小于6位\"\r\n        }\r\n        else if(pass=='')\r\n        {\r\n            msg=\"请输入密码\";\r\n            \r\n        }\r\n        else if(pass.length<6)\r\n        {\r\n            msg=\"密码不能小于6位\"\r\n        }\r\n        else if(pass!=confirmpass)\r\n        {\r\n            msg=\"两次密码不一致\"\r\n        }\r\n        else if(isNaN(tjren)||tjren<=0)\r\n        {\r\n            tjren=0;\r\n            //msg=\"请填写推荐人\";\r\n        }\r\n        if(msg!='')\r\n        {\r\n            this.tanKuang(msg);\r\n        }\r\n        else\r\n        {\r\n            this.xhr.xmlHttpPost('user/registered',{'parentId':tjren,'username':username,'password':pass},'',this.loginSuccess,this.httpFail);\r\n        }\r\n    },\r\n    loginSuccess:function(res,header){\r\n        if (res['error']==0) {\r\n             //保存用户数据，用于游戏界面显示\"utype\":0游客，1帐号登录\r\n             var udata=res['data'];\r\n             var userinfo={utype:res['utype'],uid:udata['uid'],type:udata['type'],coin:udata['coin'],name:udata['username']};\r\n             cc.sys.localStorage.setItem(\"userinfo\",JSON.stringify(userinfo));\r\n             cc.sys.localStorage.setItem(\"userCookie\",header.cookie);\r\n             cc.director.loadScene(\"Playgame\");\r\n        }\r\n        else\r\n        {\r\n           var tankuang=cc.find(\"Canvas/box/tankuangbg\");\r\n           var tankuangtxt=cc.find(\"Canvas/box/tankuangbg/msgtxt\").getComponent(cc.Label);\r\n           tankuangtxt.string=res['msg'];\r\n           if(!tankuang.active)\r\n           {\r\n                tankuang.active=true;\r\n           }\r\n           tankuang.getComponent(cc.Animation).play();\r\n        }\r\n    },\r\n    loginBtn:function(){\r\n        var username=this.loginuser.string;\r\n        var pass=this.loginpass.string;\r\n        var msg='';\r\n        if(username=='')\r\n        {\r\n            msg=\"请输入用户名\";\r\n            \r\n        }\r\n        else if(username.length<6)\r\n        {\r\n            msg=\"帐号不能小于6位\"\r\n        }\r\n        else if(pass=='')\r\n        {\r\n            msg=\"请输入密码\";\r\n            \r\n        }\r\n        else if(pass.length<6)\r\n        {\r\n            msg=\"密码不能小于6位\"\r\n        }\r\n        if(msg!='')\r\n        {\r\n            this.tanKuang(msg);\r\n        }\r\n        else\r\n        {\r\n            this.xhr.xmlHttpPost('user/loginedto',{'username':username,'password':pass},'',this.loginSuccess,this.httpFail);\r\n        }\r\n    }\r\n});\r\n"]}